var e=Object.assign;import{e as t,u as n,r as a,c as o,R as s,a as r,b as l,d as c,f as i,g as u,h as d,i as m,j as p,k as f,l as h,A as g,F as v,m as E,N as y,n as w,o as b,p as N,q as x,s as C,t as S,H as k}from"./vendor.b176d855.js";function P(){return"ClashX Runtime"===navigator.userAgent}!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,s)=>{const r=new URL(e,a);if(self[t].moduleMap[r])return n(self[t].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){s(new Error(`Failed to import: ${e}`)),o(c)},onload(){n(self[t].moduleMap[r]),o(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("assets/");let T=null;class L{constructor(e){this.instance=null,window.WebViewJavascriptBridge&&(this.instance=window.WebViewJavascriptBridge),this.initBridge((t=>{this.instance=t,e()}))}initBridge(e){if(!P())return null==e?void 0:e(null);if(window.WebViewJavascriptBridge)return e(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];const t=document.createElement("iframe");t.style.display="none",t.src="https://__bridge_loaded__",document.documentElement.appendChild(t),setTimeout((()=>document.documentElement.removeChild(t)),0)}callHandler(e,t){return new Promise((n=>{var a;null==(a=this.instance)||a.callHandler(e,t,n)}))}ping(){return this.callHandler("ping")}readConfigString(){return this.callHandler("readConfigString")}getPasteboard(){return this.callHandler("getPasteboard")}getAPIInfo(){return this.callHandler("apiInfo")}setPasteboard(e){return this.callHandler("setPasteboard",e)}writeConfigWithString(e){return this.callHandler("writeConfigWithString",e)}setSystemProxy(e){return this.callHandler("setSystemProxy",e)}getStartAtLogin(){return this.callHandler("getStartAtLogin")}getProxyDelay(e){return this.callHandler("speedTest",e)}setStartAtLogin(e){return this.callHandler("setStartAtLogin",e)}isSystemProxySet(){return this.callHandler("isSystemProxySet")}}var $;($||($={})).SPEED_NOTIFY="speed-notify";var D=new class{constructor(){this.EE=new t}notifySpeedTest(){this.EE.emit($.SPEED_NOTIFY)}subscribe(e,t){this.EE.addListener(e,t)}unsubscribe(e,t){this.EE.removeListener(e,t)}};function R(e,t=""){return window.localStorage.getItem(e)||t}function I(e,t){return window.localStorage.setItem(e,t)}function B(){}async function A(e){try{return[await e,null]}catch(t){return[null,t]}}function M(e){const[t,o]=n(e);return[t,a.useMemo((()=>function(e,t){"string"==typeof e?o((n=>{const a=t;n[e]=a})):"function"==typeof e?o(e):"object"==typeof e&&o((t=>{const n=e;for(const e of Object.keys(n)){const a=e;t[a]=n[a]}}))}),[o])]}function H(e=!1){const[t,n]=a.useState(e);return{visible:t,hide:function(){n(!1)},show:function(){n(!0)}}}function U(e){const{title:t,children:n,className:s,style:r}=e;return a.createElement("header",{className:o("header",s),style:r},a.createElement("h1",null,t),a.createElement("div",{className:"operations"},n))}function O(t){const{type:n,size:s=14,className:r,style:l}=t,c=o("clash-iconfont",`icon-${n}`,r),i=e({fontSize:s},l),u=e(e({},t),{className:c,style:i});return a.createElement("i",e({},u))}function F(e){const{className:t,checked:n=!1,disabled:s=!1,onChange:r=B}=e,l=o("switch",{checked:n,disabled:s},t);return a.createElement("div",{className:l,onClick:function(){s||r(!n)}},a.createElement(O,{className:"switch-icon",type:"check",size:20,style:{fontWeight:"bold"}}))}function W(e){const{className:t,style:n,children:s}=e;return a.createElement("div",{className:o("card",t),style:n},s)}function z(e){const{gutter:t=24,align:n="top",justify:s="start",className:r,style:l,children:c}=e;return a.createElement("div",{className:o("row",`row-gutter-${t}`,`row-align-${n}`,`row-justify-${s}`,r),style:l},c)}function _(e){const{offset:t=0,order:n=0,span:s=1,className:r,style:l,children:c}=e,i=Object.assign({},{order:n},l);return a.createElement("div",{className:o("column",`column-offset-${t}`,`column-span-${s}`,r),style:i},c)}function j(e){const{options:t,value:n,onSelect:s}=e;return a.createElement("div",{className:"button-select"},t.map((e=>a.createElement("button",{value:e.value,key:e.value,className:o("button-select-options",{actived:n===e.value}),onClick:()=>null==s?void 0:s(e.value)},e.label))))}const G={en_US:{SideBar:{Proxies:"Proxies",Overview:"Overview",Logs:"Logs",Rules:"Rules",Settings:"Setting",Connections:"Connections",Version:"Version",Speed:"Network Speed"},Settings:{title:"Settings",labels:{startAtLogin:"Start at login",language:"language",setAsSystemProxy:"Set as system proxy",allowConnectFromLan:"Allow connect from Lan",proxyMode:"Mode",socks5ProxyPort:"Socks5 proxy port",httpProxyPort:"HTTP proxy port",mixedProxyPort:"Mixed proxy port",externalController:"External controller",logLevel:"Log Level",Speed:"Speed",Upload:"Upload Speed",Download:"Download Speed"},values:{cn:"中文",en:"English",global:"Global",rules:"Rules",direct:"Direct",script:"Script",info:"Info",warning:"Warn",error:"Error",debug:"Debug",silent:"Silent"},versionString:"Current ClashX is the latest version：{{version}}",checkUpdate:"Check Update",externalControllerSetting:{title:"External Controller",note:"Please note that modifying this configuration will only configure Dashboard. Will not modify your Clash configuration file. Please make sure that the external controller address matches the address in the Clash configuration file, otherwise, Dashboard will not be able to connect to Clash.",protocol:"Protocol",host:"Host",port:"Port",secret:"Secret"}},Logs:{title:"Logs"},Rules:{title:"Rules",providerTitle:"Providers",providerUpdateTime:"Last updated at",ruleCount:"Rule count"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{host:"Host",network:"Network",type:"Type",chains:"Chains",rule:"Rule",time:"Time",speed:"Speed",upload:"Upload",download:"Download",sourceIP:"Source IP"}},Proxies:{title:"Proxies",editDialog:{title:"Edit Proxy",color:"Color",name:"Name",type:"Type",server:"Server",port:"Port",password:"Password",cipher:"Cipher",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"Policy Group",providerTitle:"Providers",providerUpdateTime:"Last updated at",expandText:"Expand",collapseText:"Collapse",speedTestText:"Speed Test",breakConnectionsText:"Close connections which include the group"},Modal:{ok:"Ok",cancel:"Cancel"}},zh_CN:{SideBar:{Proxies:"代理",Overview:"总览",Logs:"日志",Rules:"规则",Settings:"设置",Connections:"连接",Version:"版本",Speed:"网络速度",Upload:"上传速度",Download:"下载速度"},Settings:{title:"设置",labels:{startAtLogin:"开机时启动",language:"语言",setAsSystemProxy:"设置为系统代理",allowConnectFromLan:"允许来自局域网的连接",proxyMode:"代理模式",socks5ProxyPort:"Socks5 代理端口",httpProxyPort:"HTTP 代理端口",mixedProxyPort:"混合代理端口",externalController:"外部控制设置",logLevel:"日志级别"},values:{cn:"中文",en:"English",global:"全局",rules:"规则",direct:"直连",script:"脚本",info:"信息",warning:"警告",error:"错误",debug:"调试",silent:"安静"},versionString:"当前 ClashX 已是最新版本：{{version}}",checkUpdate:"检查更新",externalControllerSetting:{title:"编辑外部控制设置",note:"请注意，修改该配置项并不会修改你的 Clash 配置文件，请确认修改后的外部控制地址和 Clash 配置文件内的地址一致，否则会导致 Dashboard 无法连接。",protocol:"Protocol",host:"Host",port:"端口",secret:"密钥"}},Logs:{title:"日志"},Rules:{title:"规则",providerTitle:"规则集",providerUpdateTime:"最后更新于",ruleCount:"规则条数"},Connections:{title:"连接",keepClosed:"保留关闭连接",total:{text:"总量",upload:"上传",download:"下载"},closeAll:{title:"警告",content:"将会关闭所有连接"},filter:{all:"全部"},columns:{host:"域名",network:"网络",type:"类型",chains:"节点链",rule:"规则",time:"连接时间",speed:"速率",upload:"上传",download:"下载",sourceIP:"来源 IP"}},Proxies:{title:"代理",editDialog:{title:"编辑代理",color:"颜色",name:"名字",type:"类型",server:"服务器",port:"端口",password:"密码",cipher:"加密方式",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"策略组",providerTitle:"代理集",providerUpdateTime:"最后更新于",expandText:"展开",collapseText:"收起",speedTestText:"测速",breakConnectionsText:"切换时打断包含策略组的连接"},Modal:{ok:"确 定",cancel:"取 消"}}},V=Object.keys(G);function X(e){const[t,n]=s(e);return[t,a.useMemo((()=>function(e,t){if("string"==typeof e)n((n=>r(n,(n=>{const a=t;n[e]=a}))));else if("function"==typeof e){const t=e;n((e=>r(e,t)))}else"object"==typeof e&&n((t=>r(t,(t=>{const n=e;for(const e of Object.keys(n)){const a=e;t[a]=n[a]}}))))}),[n])]}function J(e){let t=null;return async function(n=!1){return t&&!n?t:(t=e(),t.catch((e=>{throw t=null,e})))}}class Y{constructor(e){this.EE=new t,this.innerBuffer=[],this.isClose=!1,this.websocketConnection=null,this.config=Object.assign({bufferLength:0,retryInterval:5e3,headers:{}},e),this.config.useWebsocket?this.websocketLoop():this.loop()}websocketLoop(){var e;const t=new URL(this.config.url);t.protocol="http:"===t.protocol?"ws:":"wss:",t.searchParams.set("token",null!=(e=this.config.token)?e:"");const n=new WebSocket(t.toString());n.addEventListener("message",(e=>{const t=JSON.parse(e.data);this.EE.emit("data",[t]),this.config.bufferLength>0&&(this.innerBuffer.push(t),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))})),n.addEventListener("close",(()=>setTimeout(this.websocketLoop,this.config.retryInterval))),n.addEventListener("error",(e=>{this.EE.emit("error",e),setTimeout(this.websocketLoop,this.config.retryInterval)})),this.websocketConnection=n}async loop(){const[e,t]=await A(fetch(this.config.url,{mode:"cors",headers:this.config.token?{Authorization:`Bearer ${this.config.token}`}:{}}));if(t||!e.body)return void this.retry(t);const n=e.body.getReader(),a=new TextDecoder;for(;!this.isClose;){const[{value:e},t]=await A(null==n?void 0:n.read());if(t){this.retry(t);break}const o=a.decode(e).trim().split("\n").map((e=>JSON.parse(e)));this.EE.emit("data",o),this.config.bufferLength>0&&(this.innerBuffer.push(...o),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}}retry(e){this.isClose||(this.EE.emit("error",e),window.setTimeout(this.loop,this.config.retryInterval))}subscribe(e,t){this.EE.addListener(e,t)}unsubscribe(e,t){this.EE.removeListener(e,t)}buffer(){return this.innerBuffer.slice()}destory(){this.EE.removeAllListeners(),this.isClose=!0}}async function K(){if(P()){const e=await T.getAPIInfo();return{hostname:e.host,port:e.port,secret:e.secret,protocol:"http"}}const e=R("externalControllerAddr","127.0.0.1"),t=R("externalControllerPort","9090"),n=R("secret",""),a="127.0.0.1"===e?"http":R("procotol","http");if(!e||!t)throw new Error("can't get hostname or port");return{hostname:e,port:t,secret:n,protocol:a}}const q=J((async()=>{const{hostname:e,port:t,secret:n,protocol:a}=await K();return l.create({baseURL:`${a}://${e}:${t}`,headers:n?{Authorization:`Bearer ${n}`}:{}})}));async function Q(){return(await q()).get("configs")}async function Z(e){return(await q()).patch("configs",e)}async function ee(){return(await q()).get("version")}async function te(e){return(await q()).delete(`connections/${e}`)}const ne=J((async function(){const e=await K(),{data:t}=await Q(),[n,a]=await A(ee()),o=!!(a?"unkonwn version":n.data.version)||!0,s=`${e.protocol}://${e.hostname}:${e.port}/logs?level=${t["log-level"]}`;return new Y({url:s,bufferLength:200,token:e.secret,useWebsocket:o})})),ae=J((async function(){const e=await K(),[t,n]=await A(ee()),a=!!(n?"unkonwn version":t.data.version)||!0,o=`${e.protocol}://${e.hostname}:${e.port}/connections`;return new Y({url:o,bufferLength:200,token:e.secret,useWebsocket:a})})),oe=c({key:"identity",default:!0});function se(){const[e,t]=s(oe);return{identity:e,wrapFetcher:function(e){return async function(...n){const[a,o]=await A(e(...n)),s=o;if(s&&(!s.response||401===s.response.status))throw t(!1),o;return t(!0),a}},set:t}}const re=c({key:"i18n",default:function(){const e=R("language");if(e&&V.includes(e))return e;const t=function(){const e=[];if(window.navigator)if(window.navigator.languages)for(const t of window.navigator.languages)e.push(t);else window.navigator.language&&e.push(navigator.language);return e}();for(const n of t){if(n.includes("zh"))return"zh_CN";if(n.includes("us"))return"en_US"}return"en_US"}()});function le(){const[e,t]=s(re);const n=a.useCallback((function(t){return{t:function(n){return d(G[e][t],n)}}}),[e]);return{lang:e,locales:V,setLang:function(e){t(e),function(e){I("language",e)}(e)},translation:n}}const ce=c({key:"version",default:{version:"",premium:!1}});function ie(){const[e,t]=s(ce),{set:n}=se();return{version:e.version,premium:e.premium,update:async function(){const[e,a]=await A(ee());n(!a),t(a?{version:"",premium:!1}:{version:e.data.version,premium:!!e.data.premium})}}}const ue=c({key:"config",default:{breakConnections:!1}});function de(){const[e,t]=X(ue);return{data:e,set:t}}const me=c({key:"proxyProvider",default:[]});function pe(){const[e,t]=s(me),{data:n,mutate:o}=u("/providers/proxy",(async()=>{const e=await async function(){return(await q()).get("providers/proxies",{validateStatus:e=>e>=200&&e<300||404===e}).then((e=>(404===e.status&&(e.data={providers:{}}),e)))}();return Object.keys(e.data.providers).map((t=>e.data.providers[t])).filter((e=>"default"!==e.name)).filter((e=>"Compatible"!==e.vehicleType))}));return a.useEffect((()=>t(null!=n?n:[])),[n,t]),{providers:e,update:o}}function fe(){const[{premium:e}]=s(ce),{data:t,mutate:n}=u("/providers/rule",(async()=>{if(!e)return[];const t=await async function(){return(await q()).get("providers/rules")}();return Object.keys(t.data.providers).map((e=>t.data.providers[e]))}));return{providers:null!=t?t:[],update:n}}function he(){const{data:e,mutate:t}=u("/config",(async()=>{var e;const t=(await Q()).data;return{port:t.port,socksPort:t["socks-port"],mixedPort:null!=(e=t["mixed-port"])?e:0,redirPort:t["redir-port"],mode:t.mode.toLowerCase(),logLevel:t["log-level"],allowLan:t["allow-lan"]}}));return{general:null!=e?e:{},update:t}}const ge=c({key:"proxies",default:{proxies:[],groups:[],global:{name:"GLOBAL",type:"Selector",now:"",history:[],all:[]}}});function ve(){const[t,n]=X(ge),{mutate:o}=u("/proxies",(async()=>{const t=await async function(){return(await q()).get("proxies")}(),a=t.data.proxies.GLOBAL;a.name="GLOBAL";const o=new Set(["Selector","URLTest","Fallback","LoadBalance"]),s=new Set(["DIRECT","REJECT","GLOBAL"]),r=a.all.filter((e=>!s.has(e))).map((n=>e(e({},t.data.proxies[n]),{name:n}))),[l,c]=function(e,t){const n=[],a=[];for(const o of e)t(o)?n.push(o):a.push(o);return[n,a]}(r,(e=>!o.has(e.type)));n({proxies:l,groups:c,global:a})})),s=a.useCallback(((e,t)=>{"GLOBAL"===e&&n((e=>{e.global.now=t})),n((n=>{for(const a of n.groups)a.name===e&&(a.now=t)}))}),[n]);return{proxies:t.proxies,groups:t.groups,global:t.global,update:o,markProxySelected:s,set:n}}const Ee=i({key:"proxyMapping",get:({get:e})=>{const t=e(ge),n=e(me),a=new Map;for(const o of t.proxies)a.set(o.name,o);for(const o of n)for(const e of o.proxies)a.set(e.name,e);return a}});function ye(){const{data:e,mutate:t}=u("/clashx",(async()=>{var e,t;if(!P())return{isClashX:!1,startAtLogin:!1,systemProxy:!1};return{startAtLogin:null!=(e=await(null==T?void 0:T.getStartAtLogin()))&&e,systemProxy:null!=(t=await(null==T?void 0:T.isSystemProxySet()))&&t,isClashX:!0}}));return{data:e,update:t}}const we=c({key:"apiData",default:{protocol:"http",hostname:"127.0.0.1",port:"9090",secret:""}});function be(){const[t,n]=s(we);return{data:t,fetch:a.useCallback((async function(){const t=await K();n(e({},t))}),[n]),update:async function(e){const{protocol:t,hostname:n,port:a,secret:o}=e;I("externalControllerAddr",n),I("externalControllerPort",a),I("secret",o),I("protocol",t),window.location.reload()}}}const Ne=c({key:"rules",default:[]});function xe(){const[e,t]=X(Ne);return{rules:e,update:async function(){const e=await async function(){return(await q()).get("rules")}();t(e.data.rules)}}}function Ce(e){const{className:t,data:n,onClick:s,select:r,canClick:l,errSet:c,rowHeight:i}=e,{translation:u}=le(),{t:d}=u("Proxies"),[m,p]=a.useState(!1),[f,h]=a.useState(!1),g=a.useRef(null);a.useLayoutEffect((()=>{var e,t;h((null!=(t=null==(e=null==g?void 0:g.current)?void 0:e.offsetHeight)?t:0)>30)}),[]);const v=m?"auto":i,E=l?s:B;const y=n.map((e=>{const t=o({"tags-selected":r===e,"can-click":l,error:null==c?void 0:c.has(e)});return a.createElement("li",{className:t,key:e,onClick:()=>E(e)},e)}));return a.createElement("div",{className:o("tags-container",t),style:{height:v}},a.createElement("ul",{ref:g,className:o("tags",{expand:m})},y),f&&a.createElement("span",{className:"tags-expand",onClick:function(){p(!m)}},d(m?"collapseText":"expandText")))}function Se(e){const{className:t,style:n,value:s="",align:r="center",inside:l=!1,autoFocus:c=!1,type:i="text",disabled:u=!1,onChange:d=B,onBlur:m=B}=e,p=o("input",`input-align-${r}`,{"input-inside":l},t);return a.createElement("input",{disabled:u,className:p,style:n,value:s,autoFocus:c,type:i,onChange:e=>d(e.target.value,e),onBlur:m})}function ke(e){const{show:t=!0,title:n="Modal",size:s="small",footer:r=!0,onOk:l=B,onClose:c=B,bodyClassName:i,bodyStyle:u,className:d,style:p,children:f}=e,{translation:h}=le(),{t:g}=h("Modal"),v=a.useRef(document.createElement("div")),E=a.useRef(null);a.useLayoutEffect((()=>{const e=v.current;return document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[]);const y=a.createElement("div",{className:o("modal-mask",{"modal-show":t}),ref:E,onMouseDown:function(e){e.target===E.current&&c()}},a.createElement("div",{className:o("modal",`modal-${s}`,d),style:p},a.createElement("div",{className:"modal-title"},n),a.createElement("div",{className:o("modal-body",i),style:u},f),r&&a.createElement("div",{className:"footer"},a.createElement(Le,{onClick:()=>c()},g("cancel")),a.createElement(Le,{type:"primary",onClick:()=>l()},g("ok")))));return m.createPortal(y,v.current)}const Pe={success:"check",info:"info",warning:"info",error:"close"};function Te(e){const{message:t="",type:n="info",inside:s=!1,children:r,className:l,style:c}=e,i=o("alert",`alert-${s?"note":"box"}-${n}`,l);return a.createElement("div",{className:i,style:c},a.createElement("span",{className:"alert-icon"},a.createElement(O,{type:Pe[n],size:26})),t?a.createElement("p",{className:"alert-message"},t):a.createElement("div",{className:"alert-message"},r))}function Le(e){const{type:t="normal",onClick:n=B,children:s,className:r,style:l}=e,c=o("button",`button-${t}`,r);return a.createElement("button",{className:c,style:l,onClick:n},s)}function $e(e){const{className:t,checked:n=!1,onChange:s=B}=e,r=o("checkbox",{checked:n},t);return a.createElement("div",{className:r,onClick:function(){s(!n)}},a.createElement(O,{className:"checkbox-icon",type:"check",size:18}),a.createElement("div",null,e.children))}function De(t){const{color:n,className:s,style:r}=t,l=o("tag",s),c=e({color:n},r),i=e(e({},t),{className:l,style:c});return a.createElement("span",e({},i),t.children)}function Re(e){const t=o("spinner",e.className);return a.createElement("div",{className:t},a.createElement("div",{className:"spinner-circle"},a.createElement("div",{className:"spinner-inner"})),a.createElement("div",{className:"spinner-circle"},a.createElement("div",{className:"spinner-inner"})),a.createElement("div",{className:"spinner-circle"},a.createElement("div",{className:"spinner-inner"})),a.createElement("div",{className:"spinner-circle"},a.createElement("div",{className:"spinner-inner"})),a.createElement("div",{className:"spinner-circle"},a.createElement("div",{className:"spinner-inner"})))}function Ie(e){const t=o("loading","visible",e.className);return e.visible?a.createElement("div",{className:t},a.createElement(Re,{className:e.spinnerClassName})):null}const Be={"#909399":0,"#00c520":260,"#ff9a28":600,"#ff3e5e":1/0};async function Ae(e){var t;if(P()){return null!=(t=await(null==T?void 0:T.getProxyDelay(e)))?t:0}const{data:{delay:n}}=await async function(e){return(await q()).get(`proxies/${encodeURIComponent(e)}/delay`,{params:{timeout:5e3,url:"http://www.gstatic.com/generate_204"}})}(e);return n}function Me(e){const{config:t,className:n}=e,{set:s}=ve(),r=a.useCallback((async function(){const[e,n]=await A(Ae(t.name)),a=n?0:e;s((e=>{const n=e.proxies.find((e=>e.name===t.name));n&&n.history.push({time:Date.now().toString(),delay:a})}))}),[t.name,s]),l=a.useMemo((()=>{var e;return(null==(e=t.history)?void 0:e.length)?t.history.slice(-1)[0].delay:0}),[t]);a.useLayoutEffect((()=>(D.subscribe($.SPEED_NOTIFY,r),()=>D.unsubscribe($.SPEED_NOTIFY,r))),[r]);const c=a.useMemo((()=>0===l),[l]),i=a.useMemo((()=>Object.keys(Be).find((e=>l<=Be[e]))),[l]),u=c?void 0:i;return a.createElement("div",{className:o("proxy-item",{"proxy-error":c},n)},a.createElement("span",{className:"proxy-type",style:{backgroundColor:u}},t.type),a.createElement("p",{className:"proxy-name"},t.name),a.createElement("p",{className:"proxy-delay"},0===l?"-":`${l}ms`))}function He(e){const{markProxySelected:t}=ve(),n=p(Ee),{data:o}=de(),{config:s}=e;const r=a.useMemo((()=>{var e;const t=new Set;for(const a of s.all){const o=null==(e=n.get(a))?void 0:e.history;(null==o?void 0:o.length)&&0===o.slice(-1)[0].delay&&t.add(a)}return t}),[s.all,n]),l="Selector"===s.type;return a.createElement("div",{className:"proxy-group"},a.createElement("div",{className:"proxy-group-part"},a.createElement("span",{className:"proxy-group-name"},s.name),a.createElement(De,{className:"proxy-group-type"},s.type)),a.createElement("div",{className:"proxy-group-tags-container"},a.createElement(Ce,{className:"proxy-group-tags",data:s.all,onClick:async function(n){if(await async function(e,t){return(await q()).put(`proxies/${encodeURIComponent(e)}`,{name:t})}(e.config.name,n),t(e.config.name,n),o.breakConnections){const t=[],n=await async function(){return(await q()).get("connections")}();for(const a of n.data.connections)a.chains.includes(e.config.name)&&t.push(a.id);for(const e of t)te(e)}},errSet:r,select:s.now,canClick:l,rowHeight:30})))}function Ue(e,t){const n="en_US"===t?"en":"zh-cn";return f().locale(n).from(e)}f.extend(h);function Oe(e){const{update:t}=pe(),{translation:n,lang:o}=le(),{provider:s}=e,{t:r}=n("Proxies"),{visible:l,hide:c,show:i}=H();const u=a.useMemo((()=>s.proxies.slice().sort(((e,t)=>-1*_e(e,t)))),[s.proxies]);return a.createElement(W,{className:"proxy-provider"},a.createElement(Ie,{visible:l}),a.createElement("div",{className:"proxy-provider-header"},a.createElement("div",{className:"proxy-provider-header-part"},a.createElement("span",{className:"proxy-provider-name"},s.name),a.createElement(De,null,s.vehicleType)),a.createElement("div",{className:"proxy-provider-header-part"},s.updatedAt&&a.createElement("span",{className:"proxy-provider-update"},`${r("providerUpdateTime")}: ${Ue(new Date(s.updatedAt),o)}`),a.createElement(O,{className:"proxy-provider-icon healthcheck",type:"healthcheck",size:18,onClick:function(){i(),async function(e){return(await q()).get(`providers/proxies/${encodeURIComponent(e)}/healthcheck`)}(s.name).then((()=>t())).finally((()=>c()))}}),a.createElement(O,{className:"proxy-provider-icon",type:"update",size:18,onClick:function(){i(),async function(e){return(await q()).put(`providers/proxies/${encodeURIComponent(e)}`)}(s.name).then((()=>t())).finally((()=>c()))}}))),a.createElement("ul",{className:"proxies-list"},u.map((e=>a.createElement("li",{key:e.name},a.createElement(Me,{className:"proxy-provider-item",config:e}))))))}var Fe,We;(We=Fe||(Fe={}))[We.None=0]="None",We[We.Asc=1]="Asc",We[We.Desc=2]="Desc";const ze={0:"sort",1:"sort-ascending",2:"sort-descending"};function _e(e,t){const n=e.history.length?e.history.slice(-1)[0].delay:0;return((t.history.length?t.history.slice(-1)[0].delay:0)||Number.MAX_SAFE_INTEGER)-(n||Number.MAX_SAFE_INTEGER)}function je(){const{groups:e,global:t}=ve(),{data:n,set:o}=de(),{general:s}=he(),{translation:r}=le(),{t:l}=r("Proxies"),c=a.useMemo((()=>"global"===s.mode?[t,...e]:e),[s,e,t]);return a.createElement(a.Fragment,null,0!==c.length&&a.createElement("div",{className:"proxies-container"},a.createElement(U,{title:l("groupTitle")},a.createElement($e,{className:"connections-filter",checked:n.breakConnections,onChange:e=>o("breakConnections",e)},l("breakConnectionsText"))),a.createElement(W,{className:"proxies-group-card"},a.createElement("ul",{className:"proxies-group-list"},c.map((e=>a.createElement("li",{className:"proxies-group-item",key:e.name},a.createElement(He,{config:e}))))))))}function Ge(){const{providers:e}=pe(),{translation:t}=le(),{t:n}=t("Proxies");return a.createElement(a.Fragment,null,0!==e.length&&a.createElement("div",{className:"proxies-container"},a.createElement(U,{title:n("providerTitle")}),a.createElement("ul",{className:"proxies-providers-list"},e.map((e=>a.createElement("li",{className:"proxies-providers-item",key:e.name},a.createElement(Oe,{provider:e})))))))}function Ve(){const{proxies:e}=ve(),{translation:t}=le(),{t:n}=t("Proxies");const{current:o,next:s}=function(e,t=0){if(e.length<2)throw new Error("List requires at least two elements");const[n,o]=a.useState(t);return{current:a.useMemo((()=>e[n]),[e,n]),next:function(){o((n+1)%e.length)}}}([1,2,0]),r=a.useMemo((()=>{switch(o){case 2:return e.slice().sort(((e,t)=>_e(e,t)));case 1:return e.slice().sort(((e,t)=>-1*_e(e,t)));default:return e.slice()}}),[o,e]),l=s;return a.createElement(a.Fragment,null,0!==r.length&&a.createElement("div",{className:"proxies-container"},a.createElement(U,{title:n("title")},a.createElement(O,{className:"proxies-action-icon",type:ze[o],onClick:l,size:20}),a.createElement(O,{className:"proxies-action-icon",type:"speed",size:20}),a.createElement("span",{className:"proxies-speed-test",onClick:function(){D.notifySpeedTest()}},n("speedTestText"))),a.createElement("ul",{className:"proxies-list"},r.map((e=>a.createElement("li",{key:e.name},a.createElement(Me,{config:e})))))))}function Xe(){return a.createElement("div",{className:"page"},a.createElement(je,null),a.createElement(Ge,null),a.createElement(Ve,null))}function Je(){const t=a.useRef(null),n=a.useRef([]),[o,s]=a.useState([]),{translation:r}=le(),{t:l}=r("Logs");return a.useLayoutEffect((()=>{const e=t.current;e&&(e.scrollTop=e.scrollHeight)})),a.useEffect((()=>{let t=null;function a(t){n.current=n.current.slice().concat(t.map((t=>e(e({},t),{time:new Date})))),s(n.current)}return async function(){t=await ne(),n.current=t.buffer(),s(n.current),t.subscribe("data",a)}(),()=>{null==t||t.unsubscribe("data",a)}}),[]),a.createElement("div",{className:"page"},a.createElement(U,{title:l("title")}),a.createElement(W,{className:"logs-card"},a.createElement("ul",{className:"logs-panel",ref:t},o.map(((e,t)=>a.createElement("li",{key:t},a.createElement("span",{className:"logs-panel-time"},f(e.time).format("YYYY-MM-DD HH:mm:ss")),a.createElement("span",null,"[",e.type,"] ",e.payload)))))))}function Ye(e){const{update:t}=fe(),{translation:n,lang:s}=le(),{provider:r}=e,{t:l}=n("Rules"),{visible:c,hide:i,show:u}=H();const d=o("rule-provider-icon",{"rule-provider-loading":c});return a.createElement(W,{className:"rule-provider"},a.createElement("div",{className:"rule-provider-header"},a.createElement("div",{className:"rule-provider-header-part"},a.createElement("span",{className:"rule-provider-name"},r.name),a.createElement(De,null,r.vehicleType),a.createElement(De,{className:"rule-provider-behavior"},r.behavior),a.createElement("span",{className:"rule-provider-update"},`${l("ruleCount")}: ${r.ruleCount}`)),a.createElement("div",{className:"rule-provider-header-part"},r.updatedAt&&a.createElement("span",{className:"rule-provider-update"},`${l("providerUpdateTime")}: ${Ue(new Date(r.updatedAt),s)}`),a.createElement(O,{className:d,type:"update",size:18,onClick:function(){u(),async function(e){return(await q()).put(`providers/rules/${encodeURIComponent(e)}`)}(r.name).then((()=>t())).finally((()=>i()))}}))))}function Ke(){const{providers:e}=fe(),{translation:t}=le(),{t:n}=t("Rules");return a.createElement(a.Fragment,null,0!==e.length&&a.createElement("div",{className:"proxies-container"},a.createElement(U,{title:n("providerTitle")}),a.createElement("ul",{className:"proxies-providers-list"},e.map((e=>a.createElement("li",{className:"proxies-providers-item",key:e.name},a.createElement(Ye,{provider:e})))))))}function qe(){const{rules:e,update:t}=xe(),{translation:n}=le(),{t:o}=n("Rules");function s({index:t,style:n}){const o=e[t];return a.createElement("li",{className:"rule-item",style:n},a.createElement(z,{className:"rule-item-row",gutter:24,align:"middle"},a.createElement(_,{className:"rule-type",span:6,offset:1},o.type),a.createElement(_,{className:"payload",span:11},o.payload),a.createElement(_,{className:"rule-proxy",span:6},o.proxy)))}return u("rules",t),a.createElement("div",{className:"page"},a.createElement(Ke,null),a.createElement(U,{title:o("title")}),a.createElement(W,{className:"rules-card"},a.createElement(g,{className:"rules"},(({height:t,width:n})=>a.createElement(v,{height:t,width:n,itemCount:e.length,itemSize:50},s)))))}const Qe=[{label:"中文",value:"zh_CN"},{label:"English",value:"en_US"}];function Ze(){var e,t,n;const{premium:s}=ie(),{data:r,update:l}=ye(),{general:c,update:i}=he(),{set:u}=se(),{data:d}=be(),{translation:m,setLang:p,lang:f}=le(),{t:h}=m("Settings"),[g,v]=M({socks5ProxyPort:7891,httpProxyPort:7890,mixedProxyPort:0});a.useEffect((()=>{var e,t,n;v("socks5ProxyPort",null!=(e=null==c?void 0:c.socksPort)?e:0),v("httpProxyPort",null!=(t=null==c?void 0:c.port)?t:0),v("mixedProxyPort",null!=(n=null==c?void 0:c.mixedPort)?n:0)}),[c,v]);const{protocol:y,hostname:w,port:b}=d,{allowLan:N,mode:x,logLevel:C}=c,S=null!=(e=null==r?void 0:r.startAtLogin)&&e,k=null!=(t=null==r?void 0:r.systemProxy)&&t,P=null!=(n=null==r?void 0:r.isClashX)&&n,L=a.useMemo((()=>{const e=[{label:h("values.global"),value:"Global"},{label:h("values.rules"),value:"Rule"},{label:h("values.direct"),value:"Direct"}];return s&&e.push({label:h("values.script"),value:"Script"}),e}),[h,s]),$=a.useMemo((()=>[{label:h("values.info"),value:"info"},{label:h("values.warning"),value:"warning"},{label:h("values.error"),value:"error"},{label:h("values.debug"),value:"debug"},{label:h("values.silent"),value:"silent"}]),[h]);return a.createElement("div",{className:"page"},a.createElement(U,{title:h("title")}),a.createElement(W,{className:"settings-card"},a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.startAtLogin"))),a.createElement(_,{span:8,className:"value-column"},a.createElement(F,{disabled:!(null==r?void 0:r.isClashX),checked:S,onChange:async function(e){await(null==T?void 0:T.setStartAtLogin(e)),l()}}))),a.createElement(_,{span:12},a.createElement(_,{span:8,offset:1},a.createElement("span",{className:"label"},h("labels.language"))),a.createElement(_,{span:14,className:"value-column"},a.createElement(j,{options:Qe,value:f,onSelect:e=>{p(e)}})))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.setAsSystemProxy"))),a.createElement(_,{span:8,className:"value-column"},a.createElement(F,{disabled:!P,checked:k,onChange:async function(e){await(null==T?void 0:T.setSystemProxy(e)),l()}}))),a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.allowConnectFromLan"))),a.createElement(_,{span:8,className:"value-column"},a.createElement(F,{checked:N,onChange:async function(e){await Z({"allow-lan":e}),await i()}}))))),a.createElement(W,{className:"settings-card"},a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:12},a.createElement(_,{span:8,offset:1},a.createElement("span",{className:"label"},h("labels.proxyMode"))),a.createElement(_,{span:14,className:"value-column"},a.createElement(j,{options:L,value:E(x),onSelect:async function(e){await Z({mode:e}),await i()}}))),a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.socks5ProxyPort"))),a.createElement(_,{span:8},a.createElement(Se,{disabled:P,value:g.socks5ProxyPort,onChange:e=>v("socks5ProxyPort",+e),onBlur:async function(){await Z({"socks-port":g.socks5ProxyPort}),await i()}})))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.httpProxyPort"))),a.createElement(_,{span:8},a.createElement(Se,{disabled:P,value:g.httpProxyPort,onChange:e=>v("httpProxyPort",+e),onBlur:async function(){await Z({port:g.httpProxyPort}),await i()}}))),a.createElement(_,{span:12},a.createElement(_,{span:14,offset:1},a.createElement("span",{className:"label"},h("labels.mixedProxyPort"))),a.createElement(_,{span:8},a.createElement(Se,{disabled:P,value:g.mixedProxyPort,onChange:e=>v("mixedProxyPort",+e),onBlur:async function(){await Z({"mixed-port":g.mixedProxyPort}),await i()}})))),a.createElement(z,null,a.createElement(_,{span:12},a.createElement(_,{span:12,offset:1},a.createElement("span",{className:"label"},h("labels.externalController"))),a.createElement(_,{className:"external-controller",span:10},a.createElement("span",{className:o({"modify-btn":!P}),onClick:()=>!P&&u(!1)},`${y}://${w}:${b}`))),a.createElement(_,{span:12},a.createElement(_,{span:8,offset:1},a.createElement("span",{className:"label"},h("labels.logLevel"))),a.createElement(_,{span:14,className:"value-column"},a.createElement(j,{options:$,value:String(C),onSelect:async function(e){var t;await Z({"log-level":e}),await i();let n=await ne();null==(t=n.websocketConnection)||t.close(),n.websocketConnection=null,await ne(!0)}}))))),a.createElement(W,{className:"clash-version",style:{display:"none"}},a.createElement("span",{className:"check-icon"},a.createElement(O,{type:"check",size:20})),a.createElement("p",{className:"version-info"},h("versionString")),a.createElement("span",{className:"check-update-btn"},h("checkUpdate"))))}var et,tt;class nt{constructor(){this.connection={uploadTotal:0,downloadTotal:0,uploadSpeed:0,downloadSpeed:0}}storeConnection({uploadTotal:e,downloadTotal:t}){this.connection.uploadSpeed=e-this.connection.uploadTotal,this.connection.uploadTotal=e,this.connection.downloadSpeed=t-this.connection.downloadTotal,this.connection.downloadTotal=t}getSpeed(){return{uploadSpeed:this.connection.uploadSpeed,downloadSpeed:this.connection.downloadSpeed}}getAll(){return this.connection}}function at(e){const t=["B","KB","MB","GB","TB"];let n=0;for(;~~(e/1024)&&n<t.length;)e/=1024,n++;return`${0===n?e:e.toFixed(2)} ${t[n]}`}function ot(e){const{routes:t}=e,{translation:n}=le(),{version:s,premium:r,update:l}=ie(),{data:c}=ye(),{t:i}=n("SideBar"),[d,m]=M({uploadTotal:0,downloadTotal:0,uploadSpeed:0,downloadSpeed:0}),p=a.useMemo((()=>new nt),[]);u("version",l);const f=t.map((({path:e,name:t,exact:n,noMobile:s})=>a.createElement("li",{className:o("item",{"no-mobile":s}),key:t},a.createElement(y,{to:e,activeClassName:"active",exact:!!n},i(t))))),h=a.useMemo((()=>p.getSpeed()),[d,m]);return a.useLayoutEffect((()=>{let e=null;function t(e){for(const t of e)p.storeConnection(t);m(p.getAll())}return async function(){e=await ae(),e.subscribe("data",t)}(),()=>{e&&e.unsubscribe("data",t)}}),[]),a.createElement("div",{className:"sidebar"},a.createElement("img",{src:"./assets/logo.b453e72f.png",alt:"logo",className:"sidebar-logo"}),a.createElement("ul",{className:"sidebar-menu"},f),a.createElement("div",{className:"sidebar-speed"},a.createElement("span",{className:"sidebar-speed-label"},i("Speed")),a.createElement("span",{className:"sidebar-speed-text"},`↑ ${at(h.uploadSpeed)}/s`),a.createElement("span",{className:"sidebar-speed-text"},`↓ ${at(h.downloadSpeed)}/s`)),a.createElement("div",{className:"sidebar-version"},a.createElement("span",{className:"sidebar-version-label"},"Clash",(null==c?void 0:c.isClashX)&&"X"," ",i("Version")),a.createElement("span",{className:"sidebar-version-text"},s),r&&a.createElement("span",{className:"sidebar-version-label"},"Premium")))}(tt=et||(et={})).Domain="Domain",tt.DomainSuffix="DomainSuffix",tt.DomainKeyword="DomainKeyword",tt.GeoIP="GeoIP",tt.IPCIDR="IPCIDR",tt.SrcIPCIDR="SrcIPCIDR",tt.SrcPort="SrcPort",tt.DstPort="DstPort",tt.MATCH="MATCH",tt.RuleSet="RuleSet";function st(e){const{translation:t}=le(),n=a.useMemo((()=>t("Connections").t),[t]),{className:s,style:r}=e,l=o("connections-devices",s);function c(t){var n;null==(n=e.onChange)||n.call(e,t)}return a.createElement("div",{className:l,style:r},a.createElement("div",{className:o("connections-devices-item",{selected:""===e.selected}),onClick:()=>c("")},n("filter.all")),e.devices.map((t=>a.createElement("div",{className:o("connections-devices-item",{selected:e.selected===t.label}),onClick:()=>c(t.label)},t.label," (",t.number,")"))))}class rt{constructor(){this.connections=new Map,this.saveDisconnection="true"===R("saveDisconnection","false")}appendToSet(t){var n;const a=t.reduce(((e,t)=>e.set(t.id,t)),new Map);for(const e of this.connections.keys())if(!a.has(e))if(this.saveDisconnection){const t=this.connections.get(e);t&&(t.completed=!0,t.uploadSpeed=0,t.downloadSpeed=0)}else this.connections.delete(e);for(const o of a.keys()){if(!this.connections.has(o)){this.connections.set(o,e(e({},a.get(o)),{uploadSpeed:0,downloadSpeed:0}));continue}const t=this.connections.get(o),s=a.get(o);null==(n=this.connections)||n.set(o,e(e({},s),{uploadSpeed:s.upload-t.upload,downloadSpeed:s.download-t.download}))}}toggleSave(){var e,t;if(this.saveDisconnection){this.saveDisconnection=!1;for(const n of this.connections.keys())(null==(t=null==(e=this.connections)?void 0:e.get(n))?void 0:t.completed)&&this.connections.delete(n)}else this.saveDisconnection=!0;return I("saveDisconnection",String(this.saveDisconnection)),this.saveDisconnection}getConnections(){return[...this.connections.values()]}}var lt,ct;(ct=lt||(lt={})).Host="host",ct.Network="network",ct.Type="type",ct.Chains="chains",ct.Rule="rule",ct.Speed="speed",ct.Upload="upload",ct.Download="download",ct.SourceIP="sourceIP",ct.Time="time";const it=new Set([lt.Network,lt.Type,lt.Rule,lt.Speed,lt.Upload,lt.Download,lt.SourceIP,lt.Time]);function ut(e){const t=["B","KB","MB","GB","TB"];let n=0;for(;~~(e/1024)&&n<t.length;)e/=1024,n++;return`${0===n?e:e.toFixed(2)} ${t[n]}`}function dt(){const{translation:t,lang:n}=le(),s=a.useMemo((()=>t("Connections").t),[t]),[r,l]=M({uploadTotal:0,downloadTotal:0}),{visible:c,show:i,hide:u}=H();const{connections:d,feed:m,save:p,toggleSave:f}=function(){const e=a.useMemo((()=>new rt),[]),t=a.useRef(!0),[n,o]=a.useState([]),[s,r]=a.useState("true"===R("saveDisconnection","false"));return{connections:n,feed:a.useCallback((function(n){e.appendToSet(n),t.current&&o(e.getConnections()),t.current=!t.current}),[e]),toggleSave:a.useCallback((function(){const n=e.toggleSave();r(n),n||o(e.getConnections()),t.current=!0}),[e]),save:s}}(),h=a.useMemo((()=>d.map((e=>({id:e.id,host:`${e.metadata.host||e.metadata.destinationIP}:${e.metadata.destinationPort}`,chains:e.chains.slice().reverse().join(" / "),rule:e.rule===et.RuleSet?`${e.rule}(${e.rulePayload})`:e.rule,time:new Date(e.start).getTime(),upload:e.upload,download:e.download,sourceIP:e.metadata.sourceIP,type:e.metadata.type,network:e.metadata.network.toUpperCase(),speed:{upload:e.uploadSpeed,download:e.downloadSpeed},completed:!!e.completed})))),[d]),g=a.useMemo((()=>{const e=w(d,"metadata.sourceIP");return Object.keys(e).map((t=>({label:t,number:e[t].length}))).sort(((e,t)=>e.label.localeCompare(t.label)))}),[d]),v=a.useRef(null),{x:E}=b(v),y=a.useMemo((()=>[{Header:s(`columns.${lt.Host}`),accessor:lt.Host,minWidth:260,width:260},{Header:s(`columns.${lt.Network}`),accessor:lt.Network,minWidth:80,width:80},{Header:s(`columns.${lt.Type}`),accessor:lt.Type,minWidth:120,width:120},{Header:s(`columns.${lt.Chains}`),accessor:lt.Chains,minWidth:200,width:200},{Header:s(`columns.${lt.Rule}`),accessor:lt.Rule,minWidth:140,width:140},{id:lt.Speed,Header:s(`columns.${lt.Speed}`),accessor:e=>[e.speed.upload,e.speed.download],sortType(e,t){const n=e.original.speed,a=t.original.speed;return n.download===a.download?n.upload-a.upload:n.download-a.download},minWidth:200,width:200,sortDescFirst:!0},{Header:s(`columns.${lt.Upload}`),accessor:lt.Upload,minWidth:100,width:100,sortDescFirst:!0},{Header:s(`columns.${lt.Download}`),accessor:lt.Download,minWidth:100,width:100,sortDescFirst:!0},{Header:s(`columns.${lt.SourceIP}`),accessor:lt.SourceIP,minWidth:140,width:140},{Header:s(`columns.${lt.Time}`),accessor:lt.Time,minWidth:120,width:120,sortType:(e,t)=>t.original.time-e.original.time}]),[s]);a.useLayoutEffect((()=>{let e=null;function t(e){for(const t of e)l({uploadTotal:t.uploadTotal,downloadTotal:t.downloadTotal}),m(t.connections)}return async function(){e=await ae(),e.subscribe("data",t)}(),()=>{e&&e.unsubscribe("data",t)}}),[m,l]);const{getTableProps:x,getTableBodyProps:C,headerGroups:S,rows:k,prepareRow:P,setFilter:T}=N.useTable({columns:y,data:h,autoResetSortBy:!1,autoResetFilters:!1,initialState:{sortBy:[{id:lt.Time,desc:!1}]}},N.useResizeColumns,N.useBlockLayout,N.useFilters,N.useSortBy),L=a.useMemo((()=>S[0]),[S]),$=a.useCallback((function(e){switch(e.column.id){case lt.Speed:return function(e,t){switch(!0){case 0===e&&0===t:return"-";case 0!==e&&0!==t:return`↑ ${ut(e)}/s ↓ ${ut(t)}/s`;case 0!==e:return`↑ ${ut(e)}/s`;default:return`↓ ${ut(t)}/s`}}(e.value[0],e.value[1]);case lt.Upload:case lt.Download:return ut(e.value);case lt.Time:return Ue(new Date(e.value),n);default:return e.value}}),[n]),[D,I]=a.useState("");return a.createElement("div",{className:"page"},a.createElement(U,{title:s("title")},a.createElement("span",{className:"connections-filter total"},`(${s("total.text")}: ${s("total.upload")} ${ut(r.uploadTotal)} ${s("total.download")} ${ut(r.downloadTotal)})`),a.createElement($e,{className:"connections-filter",checked:p,onChange:f},s("keepClosed")),a.createElement(O,{className:"connections-filter dangerous",onClick:i,type:"close-all",size:20})),g.length>1&&a.createElement(st,{devices:g,selected:D,onChange:function(e){I(e),null==T||T(lt.SourceIP,e)}}),a.createElement(W,{className:"connections-card"},a.createElement("div",e(e({},x()),{className:"connections",ref:v}),a.createElement("div",e(e({},L.getHeaderGroupProps()),{className:"connections-header"}),L.headers.map(((t,n)=>{const s=t,r=s.id;return a.createElement("div",e(e({},s.getHeaderProps()),{className:o("connections-th",{resizing:s.isResizing,fixed:E>0&&s.id===lt.Host}),key:r}),a.createElement("div",e({},s.getSortByToggleProps()),t.render("Header"),s.isSorted?s.isSortedDesc?" ↓":" ↑":null),n!==L.headers.length-1&&a.createElement("div",e(e({},s.getResizerProps()),{className:"connections-resizer"})))}))),a.createElement("div",e(e({},C()),{className:"connections-body"}),k.map((t=>(P(t),a.createElement("div",e(e({},t.getRowProps()),{className:"connections-item",key:t.original.id}),t.cells.map((n=>{const s=o("connections-block",{center:it.has(n.column.id),completed:t.original.completed},{fixed:E>0&&n.column.id===lt.Host});return a.createElement("div",e(e({},n.getCellProps()),{className:s,key:n.column.id}),$(n))}))))))))),a.createElement(ke,{title:s("closeAll.title"),show:c,onClose:u,onOk:function(){(async function(){return(await q()).delete("connections")})().finally((()=>u()))}},s("closeAll.content")))}function mt(){const{translation:e}=le(),{t:t}=e("Settings"),{data:n,update:o,fetch:s}=be(),{identity:r,set:l}=se(),[c,i]=M({protocol:"",hostname:"",port:"",secret:""});return a.useEffect((()=>{s()}),[s]),a.useEffect((()=>{i({protocol:n.protocol,hostname:n.hostname,port:n.port,secret:n.secret})}),[n,i]),a.createElement(ke,{show:!r,title:t("externalControllerSetting.title"),bodyClassName:"external-controller",onClose:()=>l(!0),onOk:function(){const{protocol:e,hostname:t,port:n,secret:a}=c;o({protocol:e,hostname:t,port:n,secret:a})}},a.createElement(Te,{type:"info",inside:!0},a.createElement("p",null,t("externalControllerSetting.note"))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:4,className:"title"},t("externalControllerSetting.protocol")),a.createElement(_,{span:20,className:"form"},a.createElement(Se,{align:"left",inside:!0,value:c.protocol,onChange:e=>i("protocol",e)}))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:4,className:"title"},t("externalControllerSetting.host")),a.createElement(_,{span:20,className:"form"},a.createElement(Se,{align:"left",inside:!0,value:c.hostname,onChange:e=>i("hostname",e)}))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:4,className:"title"},t("externalControllerSetting.port")),a.createElement(_,{span:20,className:"form"},a.createElement(Se,{align:"left",inside:!0,value:c.port,onChange:e=>i("port",e)}))),a.createElement(z,{gutter:24,align:"middle"},a.createElement(_,{span:4,className:"title"},t("externalControllerSetting.secret")),a.createElement(_,{span:20,className:"form"},a.createElement(Se,{align:"left",inside:!0,value:c.secret,onChange:e=>i("secret",e)}))))}var pt;function ft(){a.useEffect((()=>{ne()}),[]);const e=[{path:"/proxies",name:"Proxies",component:Xe},{path:"/logs",name:"Logs",component:Je},{path:"/rules",name:"Rules",component:qe,noMobile:!0},{path:"/connections",name:"Connections",component:dt,noMobile:!0},{path:"/settings",name:"Settings",component:Ze}];return a.createElement("div",{className:o("app",{"not-clashx":!P()})},a.createElement(ot,{routes:e}),a.createElement("div",{className:"page-container"},a.createElement(x,{exact:!0,path:"/",component:()=>a.createElement(C,{to:"/proxies"})}),e.map((e=>a.createElement(x,{exact:!1,path:e.path,key:e.path,component:e.component})))),a.createElement(mt,null))}function ht(){const e=document.getElementById("root"),t=a.createElement(S,null,a.createElement(k,null,a.createElement(ft,null)));m.render(t,e)}P()?(pt=()=>ht(),T?pt():T=new L(pt)):ht();
